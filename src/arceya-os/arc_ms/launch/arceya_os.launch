<?xml version="1.0" encoding="UTF-8"?>

<launch>

    <arg name="mode" default="sw" />
    <arg name="gazebo" default="false" />
    <arg name="usb_cam" default="false" />

    <group if="$(eval mode == 'sw')">


        <!-- roslaunch rosbridge_server rosbridge_websocket.launch -->
        <include file="$(find rosbridge_server)/launch/rosbridge_websocket.launch">
            <arg name="port" value="9090"/>
            <arg name="ssl" value="True"/>
            <arg name="certfile" value="$(find arc_ms)/cert.pem"/>
            <arg name="keyfile" value="$(find arc_ms)/key.pem"/>
        </include>
        <!-- <include file="$(find rosbridge_server)/launch/rosbridge_websocket.launch" >
            <arg name="port" value="9090"/>
        </include> -->

        <!-- roslaunch arc_ms arc_ms.launch -->
        <node name="arc_auth" pkg="arc_ms" type="arc_auth" output="screen" />

        <!-- roslaunch mecanum_drive gazebo.launch -->
        <include file="$(find mecanum_drive)/launch/gazebo.launch" if="$(arg gazebo)" />
        
        <!-- roslaunch cmd_vel_controller dd_controller.launch -->
        <include file="$(find cmd_vel_controller)/launch/dd_controller.launch" />

        <!-- rosrun usb_cam usb_cam_node _pixel_format:=yuyv     -->
        <node name="usb_cam" pkg="usb_cam" type="usb_cam_node" output="screen" if="$(arg usb_cam)" >
            <param name="pixel_format" type="string" value="yuyv" />
        </node>

    </group>



    <group if="$(eval mode == 'hw')">

        <!-- rosrun rosserial_python serial_node.py /dev/ttyACM0 -->
        <node pkg="rosserial_python" type="serial_node.py" name="serial_node" output="screen">
            <param name="port" value="/dev/ttyACM0" />
        </node>

        <!-- roslaunch rosbridge_server rosbridge_websocket.launch -->
        <include file="$(find rosbridge_server)/launch/rosbridge_websocket.launch" >
            <arg name="port" value="9090"/>
        </include>

        <!-- roslaunch arc_ms arc_ms.launch -->
        <node name="arc_auth" pkg="arc_ms" type="arc_auth" output="screen" />
        
        <!-- roslaunch cmd_vel_controller dd_controller.launch -->
        <include file="$(find cmd_vel_controller)/launch/dd_controller.launch" />

        <!-- rosrun usb_cam usb_cam_node _pixel_format:=yuyv     -->
        <node name="usb_cam" pkg="usb_cam" type="usb_cam_node" output="screen" if="$(arg usb_cam)" >
            <param name="pixel_format" type="string" value="yuyv" />
        </node>

    </group>


</launch>